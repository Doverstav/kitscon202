{"version":3,"sources":["res/giphy.gif","res/song.mp3","components/common/Link.js","components/common/Separator.js","components/Home.js","components/Ads/Ads.js","components/MonetizedContent/MonetizedContent.js","components/common/Button.js","components/WebMonetizationSpoofer/WebMonetizationSpoofer.js","App.js","index.js"],"names":["module","exports","Link","props","className","href","text","Separator","Home","monetization","useMonetizationState","state","src","BananaGif","alt","MonetizedContent","audioPlayer","useRef","useEffect","monetizationTag","document","head","querySelector","removeChild","current","addEventListener","appendChild","controls","ref","SweetTune","type","Button","classNames","active","leftAlign","onClick","WebMonetizationSpoofer","useState","isWebMonetized","setIsWebMonetized","wmStatus","setWMStatus","wmTag","startWMTimer","wmInterval","requestId","dispatchWMProgressEvent","progressEvent","CustomEvent","detail","paymentPointer","amount","assetCode","assetScale","dispatchEvent","dispatchWMStateEvent","wmEvent","stateEvent","finalized","undefined","setWMState","startWM","console","log","setInterval","toggleWM","clearTimeout","clearInterval","Math","random","toString","substring","Date","now","setTimeout","createElement","content","MutationObserver","mutations","mutatedWMTag","observe","childList","App","activePage","setActivePage","displayedComponent","setDisplayedComponent","ReactDOM","render","StrictMode","getElementById"],"mappings":"mGAAAA,EAAOC,QAAU,IAA0B,mC,gBCA3CD,EAAOC,QAAU,IAA0B,kC,+QCE5B,SAASC,EAAKC,GAC3B,OACE,uBAAGC,UAAU,OAAOC,KAAMF,EAAME,MAAOF,EAAMG,M,MCDlC,SAASC,EAAUJ,GAChC,OAAO,yBAAKC,UAAU,c,0BCKT,SAASI,EAAKL,GAC3B,IAAMM,EAAeC,cAErB,OACE,6BACE,2DACA,0MAKA,uFAC4D,IAC1D,kBAAC,EAAD,CAAML,KAAK,IAAIC,KAAK,eAEtB,kBAAC,EAAD,MACA,6BACKG,EAAaE,OAAgC,YAAvBF,EAAaE,QACpC,sDACsB,YAAvBF,EAAaE,OAAuB,aACb,YAAvBF,EAAaE,OAAuB,kDAEf,YAAvBF,EAAaE,MACZ,6BACE,yBAAKC,IAAKC,IAAWC,IAAI,cACzB,uBAAGV,UAAU,mBAAb,iBACiB,IACf,kBAAC,EAAD,CAAMC,KAAK,wBAAwBC,KAAK,WAG1C,MCrCK,SAASE,EAAKL,GAC3B,OACE,6BACE,6CACA,uKAIA,yF,oBCPS,SAASY,EAAiBZ,GACvC,IAAIa,EAAcC,mBAsBlB,OApBAC,qBAAU,WACR,IAAIC,EAAkBC,SAASC,KAAKC,cAClC,6BAaF,OAVAF,SAASC,KAAKE,YAAYJ,GAE1BH,EAAYQ,QAAQC,iBAAiB,QAAQ,WAC3CL,SAASC,KAAKK,YAAYP,MAG5BH,EAAYQ,QAAQC,iBAAiB,SAAS,WAC5CL,SAASC,KAAKE,YAAYJ,MAGrB,WACLC,SAASC,KAAKK,YAAYP,MAE3B,IAGD,6BACE,iDACA,uTAMA,2BAAOQ,UAAQ,EAACC,IAAKZ,GACnB,4BAAQJ,IAAKiB,IAAWC,KAAK,iB,YCjCtB,SAASC,EAAO5B,GAC7B,IAAI6B,EAAU,iBAAa7B,EAAM8B,OAAS,gBAAkB,GAA9C,YAAoD9B,EAAM+B,UAAY,mBAAqB,IACzG,OACE,yBAAK9B,UAAW4B,EAAYG,QAAShC,EAAMgC,SACxChC,EAAMG,MCKE,SAAS8B,EAAuBjC,GAAO,MAERkC,oBAAS,GAFD,mBAE7CC,EAF6C,KAE7BC,EAF6B,OAGpBF,mBAAS,IAHW,mBAG7CG,EAH6C,KAGnCC,EAHmC,KAM9CC,EAAQzB,mBACR0B,EAAe1B,mBACf2B,EAAa3B,mBACb4B,EAAY5B,mBAEZ6B,EAA0B,WAC9B,IAAMC,EAAgB,IAAIC,YAdJ,uBAcmC,CACvDC,OAAQ,CACNJ,UAAWA,EAAUrB,QACrB0B,eAAgBR,EAAMlB,QACtB2B,OAAQ,EACRC,UAAW,MACXC,WAAY,KAIhBjC,SAASX,aAAa6C,cAAcP,IAGhCQ,EAAuB,SAACC,GAC5B,IAAMC,EAAa,IAAIT,YAAYQ,EAAS,CAC1CP,OAAQ,CACNJ,UAAWA,EAAUrB,QACrB0B,eAAgBR,EAAMlB,QACtBkC,UAnCiB,qBAmCNF,QAAsCG,KAIrDvC,SAASX,aAAa6C,cAAcG,IAkBhCG,EAAa,SAACjD,GAClB8B,EAAY9B,GACZS,SAASX,aAAaE,MAAQA,GAG1BkD,EAAU,WACdC,QAAQC,IAAR,8BAAmClB,EAAUrB,UAE7CoC,EAlEqB,WAmErBL,EAjEqB,qBAmErBT,IACAF,EAAWpB,QAAUwC,aAAY,WAC/BF,QAAQC,IAAR,6BAAkClB,EAAUrB,UAC5CsB,MACC,MAcCmB,EAAW,WAvFM,YAwFjBzB,GAzFiB,YAyFgBA,GAXrCsB,QAAQC,IAAI,eAEZH,EAjFqB,WAkFrBL,EA/EqB,oBAkFrBW,aAAavB,EAAanB,SAC1B2C,cAAcvB,EAAWpB,WAxCzBsC,QAAQC,IAAI,iBACZlB,EAAUrB,QACR4C,KAAKC,SAASC,SAAS,IAAIC,UAAU,GAAKC,KAAKC,MAAMH,SAAS,IAIhER,QAAQC,IAAI,cAEZH,EArDqB,WAsDrBL,EAlDqB,uBAoDrBZ,EAAanB,QAAUkD,WAAWb,EAAS,OA6E7C,OApCA3C,qBAAU,WACR4C,QAAQC,IAAI,cACZ3C,SAASX,aAAeW,SAASuD,cAAc,OAC/Cf,EArGqB,aAsGpB,IAEH1C,qBAAU,WAERwB,EAAMlB,QAAUJ,SAASC,KAAKC,cAC5B,6BACAsD,QACFrC,IAAoBG,EAAMlB,SAGL,IAAIqD,kBAAiB,SAACC,GACzC,IAAMC,EAAe3D,SAASC,KAAKC,cACjC,6BAIEyD,GACFjB,QAAQC,IAAR,qBAA0BgB,EAAaH,UACvClC,EAAMlB,QAAUuD,EAAaH,QAC7BrC,GAAkB,KAGlBuB,QAAQC,IAAI,iBACZrB,EAAMlB,aAAUmC,EAChBpB,GAAkB,OAKTyC,QAAQ5D,SAASC,KAAM,CAAE4D,WAAW,MAChD,IAGD,yBAAK7E,UAAU,uBACb,kBAAC,EAAD,CACE+B,QAAS,kBAAM8B,KACf3D,KAAI,UA1Ia,YA2IfkC,EAAgC,QAAU,OADxC,qBAGJP,OA7IiB,YA6ITO,IAEV,oEACA,oDACyBF,EAAiB,SAAW,kBAErD,mDAAyBE,GACzB,oFC9FS0C,MA7Cf,WAAgB,IAAD,EACuB7C,mBAHzB,QAEE,mBACN8C,EADM,KACMC,EADN,OAEuC/C,mBAAS,kBAAC,EAAD,OAFhD,mBAENgD,EAFM,KAEcC,EAFd,KAcb,OAVApE,qBAAU,WAENoE,EAVM,QASJH,EACoB,kBAAC,EAAD,MATF,qBAUXA,EACa,kBAACpE,EAAD,MAEA,kBAAC,EAAD,SAEvB,CAACoE,IAGF,yBAAK/E,UAAU,OACb,yBAAKA,UAAU,WACb,kBAAC,EAAD,CACE+B,QAAS,kBAAMiD,EApBZ,SAqBH9E,KAAM,OACN2B,OAtBG,SAsBKkD,EACRjD,WAAW,IAEb,kBAAC,EAAD,CACEC,QAAS,kBAAMiD,EA5Bb,QA6BF9E,KAAM,MACN2B,OA9BE,QA8BMkD,EACRjD,WAAW,IAEb,kBAAC,EAAD,CACEC,QAAS,kBAAMiD,EAjCC,qBAkChB9E,KAAM,oBACN2B,OAnCgB,qBAmCRkD,EACRjD,WAAW,IAEb,kBAAC,EAAD,MACA,kBAACE,EAAD,OAEF,yBAAKhC,UAAU,WACb,yBAAKA,UAAU,iBAAiBiF,MC/CxCE,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAAC,EAAD,OAEFrE,SAASsE,eAAe,W","file":"static/js/main.2d6f2382.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/giphy.68673820.gif\";","module.exports = __webpack_public_path__ + \"static/media/song.2250bca0.mp3\";","import React from \"react\"\r\nimport \"./Link.css\"\r\nexport default function Link(props) {\r\n  return (\r\n    <a className=\"Link\" href={props.href}>{props.text}</a>\r\n  )\r\n}","import React from 'react'\r\nimport \"./Separator.css\"\r\n\r\nexport default function Separator(props) {\r\n  return <div className=\"Separator\"></div>\r\n}","import React from \"react\";\r\nimport { useMonetizationState } from \"react-web-monetization\";\r\n\r\nimport Link from \"./common/Link\";\r\nimport Separator from \"./common/Separator\";\r\n\r\nimport BananaGif from \"../res/giphy.gif\";\r\nimport \"./Home.css\"\r\n\r\nexport default function Home(props) {\r\n  const monetization = useMonetizationState();\r\n\r\n  return (\r\n    <div>\r\n      <h1>Here's a nice lil headline!</h1>\r\n      <p>\r\n        Welcome home! This page should probably work as an expaliner for what\r\n        this site is trying to do. I could probably bake the \"Exclusive\r\n        Content\"-demo into this page as well.\r\n      </p>\r\n      <p>\r\n        Look at this text that is ended with a nice looking link:{\" \"}\r\n        <Link href=\"/\" text=\"Click me!\" />\r\n      </p>\r\n      <Separator />\r\n      <p>\r\n        {(!monetization.state || monetization.state === \"stopped\") &&\r\n          \"Start Web Monetization to unlock exclusive content!\"}\r\n        {monetization.state === \"pending\" && \"Loading...\"}\r\n        {monetization.state === \"started\" && \"Very nice! Please enjoy your exlusive content.\"}\r\n      </p>\r\n      {monetization.state === \"started\" ? (\r\n        <div>\r\n          <img src={BananaGif} alt=\"BananaGif\" />\r\n          <p className=\"Home-text-small\">\r\n            Gif taken from{\" \"}\r\n            <Link href=\"http://gph.is/2o30x8S\" text=\"here\" />\r\n          </p>\r\n        </div>\r\n      ) : null}\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\n\r\nexport default function Home(props) {\r\n  return (\r\n    <div>\r\n      <h1>Removable ads</h1>\r\n      <p>\r\n        Allow the user to choose! Either they can pay you directly using Web\r\n        Monetization, or you can serve them some ads if they do not use it.\r\n      </p>\r\n      <p>Toogle Web monetization on and off to see the difference.</p>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useEffect, useRef } from \"react\";\r\nimport SweetTune from \"../../res/song.mp3\";\r\n\r\nexport default function MonetizedContent(props) {\r\n  let audioPlayer = useRef();\r\n\r\n  useEffect(() => {\r\n    let monetizationTag = document.head.querySelector(\r\n      'meta[name=\"monetization\"]'\r\n    );\r\n\r\n    document.head.removeChild(monetizationTag);\r\n\r\n    audioPlayer.current.addEventListener(\"play\", () => {\r\n      document.head.appendChild(monetizationTag);\r\n    });\r\n\r\n    audioPlayer.current.addEventListener(\"pause\", () => {\r\n      document.head.removeChild(monetizationTag);\r\n    });\r\n\r\n    return () => {\r\n      document.head.appendChild(monetizationTag);\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <div>\r\n      <h1>Monetized Content</h1>\r\n      <p>\r\n        Monetize playback of your content! This page has no monetization tag by\r\n        defualt, it is instead added when you start playing the song below. Whne\r\n        you pause, or hte song ends, the monetization tag is removed. This menas\r\n        that you will only pay for the amount of time spent listening!\r\n      </p>\r\n      <audio controls ref={audioPlayer}>\r\n        <source src={SweetTune} type=\"audio/mpeg\" />\r\n      </audio>\r\n    </div>\r\n  );\r\n}\r\n","import React from \"react\";\r\nimport \"./Button.css\";\r\n\r\nexport default function Button(props) {\r\n  let classNames = `Button ${props.active ? \"Button-active\" : \"\"} ${props.leftAlign ? \"Button-leftalign\" : \"\"}`;\r\n  return (\r\n    <div className={classNames} onClick={props.onClick}>\r\n      {props.text}\r\n    </div>\r\n  );\r\n}\r\n","import React, { useEffect, useRef, useState } from \"react\";\r\nimport \"./WMSpoofer.css\";\r\nimport Button from \"../common/Button\";\r\n\r\nconst WM_STATE_STOPPED = \"stopped\";\r\nconst WM_STATE_PENDING = \"pending\";\r\nconst WM_STATE_STARTED = \"started\";\r\nconst WM_EVENT_STOPPED = \"monetizationstop\";\r\nconst WM_EVENT_STARTED = \"monetizationstart\";\r\nconst WM_EVENT_PENDING = \"monetizationpending\";\r\nconst WM_EVENT_PROGRESS = \"monetizationprogress\";\r\n\r\nexport default function WebMonetizationSpoofer(props) {\r\n  // User-facing state\r\n  const [isWebMonetized, setIsWebMonetized] = useState(false);\r\n  const [wmStatus, setWMStatus] = useState(\"\");\r\n\r\n  // Internal WM state\r\n  const wmTag = useRef();\r\n  const startWMTimer = useRef();\r\n  const wmInterval = useRef();\r\n  const requestId = useRef();\r\n\r\n  const dispatchWMProgressEvent = () => {\r\n    const progressEvent = new CustomEvent(WM_EVENT_PROGRESS, {\r\n      detail: {\r\n        requestId: requestId.current,\r\n        paymentPointer: wmTag.current,\r\n        amount: 1,\r\n        assetCode: \"SEK\",\r\n        assetScale: 3,\r\n      },\r\n    });\r\n\r\n    document.monetization.dispatchEvent(progressEvent);\r\n  };\r\n\r\n  const dispatchWMStateEvent = (wmEvent) => {\r\n    const stateEvent = new CustomEvent(wmEvent, {\r\n      detail: {\r\n        requestId: requestId.current,\r\n        paymentPointer: wmTag.current,\r\n        finalized: wmEvent === WM_EVENT_STOPPED ? true : undefined, // Should payment not be final?\r\n      },\r\n    });\r\n\r\n    document.monetization.dispatchEvent(stateEvent);\r\n  };\r\n\r\n  const generateId = () => {\r\n    console.log(\"Generating id\");\r\n    requestId.current =\r\n      Math.random().toString(36).substring(2) + Date.now().toString(36);\r\n  };\r\n\r\n  const pendingWM = () => {\r\n    console.log(\"Pending WM\");\r\n\r\n    setWMState(WM_STATE_PENDING);\r\n    dispatchWMStateEvent(WM_EVENT_PENDING);\r\n\r\n    startWMTimer.current = setTimeout(startWM, 1000);\r\n  };\r\n\r\n  const setWMState = (state) => {\r\n    setWMStatus(state);\r\n    document.monetization.state = state;\r\n  };\r\n\r\n  const startWM = () => {\r\n    console.log(`Starting WM with id ${requestId.current}`);\r\n\r\n    setWMState(WM_STATE_STARTED);\r\n    dispatchWMStateEvent(WM_EVENT_STARTED);\r\n\r\n    dispatchWMProgressEvent();\r\n    wmInterval.current = setInterval(() => {\r\n      console.log(`Sending money! id: ${requestId.current}`);\r\n      dispatchWMProgressEvent();\r\n    }, 1000);\r\n  };\r\n\r\n  const stopWM = () => {\r\n    console.log(\"Stopping WM\");\r\n\r\n    setWMState(WM_STATE_STOPPED);\r\n    dispatchWMStateEvent(WM_EVENT_STOPPED);\r\n\r\n    // Clear timer & interval\r\n    clearTimeout(startWMTimer.current);\r\n    clearInterval(wmInterval.current);\r\n  };\r\n\r\n  const toggleWM = () => {\r\n    if (wmStatus === WM_STATE_STARTED || wmStatus === WM_STATE_PENDING) {\r\n      stopWM();\r\n    } else {\r\n      generateId();\r\n      pendingWM();\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    console.log(\"setting WM\");\r\n    document.monetization = document.createElement(\"div\");\r\n    setWMState(WM_STATE_STOPPED);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    // Set initial state of wmTag\r\n    wmTag.current = document.head.querySelector(\r\n      'meta[name=\"monetization\"]'\r\n    ).content;\r\n    setIsWebMonetized(!!wmTag.current);\r\n\r\n    // Observe further changes\r\n    const headObserver = new MutationObserver((mutations) => {\r\n      const mutatedWMTag = document.head.querySelector(\r\n        'meta[name=\"monetization\"]'\r\n      );\r\n\r\n      // Stop and start WM intelligently here!!\r\n      if (mutatedWMTag) {\r\n        console.log(`New wmTag: ${mutatedWMTag.content}`);\r\n        wmTag.current = mutatedWMTag.content;\r\n        setIsWebMonetized(true);\r\n        // Resume WM if it ws started by user previously, otherwise do nothing\r\n      } else {\r\n        console.log(\"wmTag removed\");\r\n        wmTag.current = undefined;\r\n        setIsWebMonetized(false);\r\n        // Stop WM\r\n      }\r\n    });\r\n\r\n    headObserver.observe(document.head, { childList: true });\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"WMSpoofer-container\">\r\n      <Button\r\n        onClick={() => toggleWM()}\r\n        text={`${\r\n          wmStatus === WM_STATE_STOPPED ? \"Start\" : \"Stop\"\r\n        } Web Monetization`}\r\n        active={wmStatus === WM_STATE_STOPPED}\r\n      />\r\n      <p>Here we can show some status about WM</p>\r\n      <p>\r\n        Web Monetization tag: {isWebMonetized ? \"Exists\" : \"Does not exist\"}\r\n      </p>\r\n      <p>Web Monetization is: {wmStatus}</p>\r\n      <p>Maybe show money sent here, with an option to reset!</p>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useState, useEffect } from \"react\";\r\nimport \"./App.css\";\r\nimport Home from \"./components/Home\";\r\nimport Ads from \"./components/Ads/Ads\";\r\nimport MonetizedContent from \"./components/MonetizedContent/MonetizedContent\";\r\nimport WebMonetizationSpoofer from \"./components/WebMonetizationSpoofer/WebMonetizationSpoofer\";\r\nimport Button from \"./components/common/Button\";\r\nimport Separator from \"./components/common/Separator\";\r\n\r\nconst ADS = \"Ads\";\r\nconst MONETIZED_CONTENT = \"MonetizedContent\";\r\nconst HOME = \"Home\";\r\n\r\nfunction App() {\r\n  const [activePage, setActivePage] = useState(HOME);\r\n  const [displayedComponent, setDisplayedComponent] = useState(<Home />);\r\n\r\n  useEffect(() => {\r\n    if (activePage === ADS) {\r\n      setDisplayedComponent(<Ads />);\r\n    } else if (activePage === MONETIZED_CONTENT) {\r\n      setDisplayedComponent(<MonetizedContent />);\r\n    } else {\r\n      setDisplayedComponent(<Home />);\r\n    }\r\n  }, [activePage]);\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <div className=\"sidebar\">\r\n        <Button\r\n          onClick={() => setActivePage(HOME)}\r\n          text={\"Home\"}\r\n          active={activePage === HOME}\r\n          leftAlign={true}\r\n        />\r\n        <Button\r\n          onClick={() => setActivePage(ADS)}\r\n          text={\"Ads\"}\r\n          active={activePage === ADS}\r\n          leftAlign={true}\r\n        />\r\n        <Button\r\n          onClick={() => setActivePage(MONETIZED_CONTENT)}\r\n          text={\"Monetized Content\"}\r\n          active={activePage === MONETIZED_CONTENT}\r\n          leftAlign={true}\r\n        />\r\n        <Separator />\r\n        <WebMonetizationSpoofer />\r\n      </div>\r\n      <div className=\"content\">\r\n        <div className=\"content-inner\">{displayedComponent}</div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n"],"sourceRoot":""}